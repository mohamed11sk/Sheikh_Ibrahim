<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>الموقع الرسمي لفضيلة الشيخ إبراهيم الحصري الأزهري</title>
  <link rel="stylesheet" href="style.css">
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-Y90GX9L2VK"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-Y90GX9L2VK');
  </script>
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&family=El+Messiri:wght@600&display=swap"
    rel="stylesheet">
  <style>
   
  </style>
</head>

<body>
  <!-- بقية الكود كما هو -->
  <!-- شريط تقدم التمرير -->
  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>

  <!-- زر تحكم مؤذن الصلاة -->
  <button class="prayer-toggle-btn" id="prayerToggleBtn">
    <i class="fas fa-mosque"></i>
    <span>أوقات الصلاة</span>
  </button>

  <!-- مؤذن الصلاة المحسن -->
  <div class="prayer-times-container" id="prayerTimesContainer">
    <div class="prayer-times-header">
      <div>
        <i class="fas fa-mosque"></i>
        <span id="currentPrayerTitle">أوقات الصلاة</span>
      </div>
      <div id="prayerLocation">القاهرة، مصر</div>
    </div>

    <div class="prayer-time" id="fajrTime">
      <span class="prayer-name">الفجر</span>
      <span class="prayer-value" id="fajrValue">--:--</span>
    </div>

    <div class="prayer-time" id="dhuhrTime">
      <span class="prayer-name">الظهر</span>
      <span class="prayer-value" id="dhuhrValue">--:--</span>
    </div>

    <div class="prayer-time" id="asrTime">
      <span class="prayer-name">العصر</span>
      <span class="prayer-value" id="asrValue">--:--</span>
    </div>

    <div class="prayer-time" id="maghribTime">
      <span class="prayer-name">المغرب</span>
      <span class="prayer-value" id="maghribValue">--:--</span>
    </div>

    <div class="prayer-time" id="ishaTime">
      <span class="prayer-name">العشاء</span>
      <span class="prayer-value" id="ishaValue">--:--</span>
    </div>

    <div class="location-info" id="locationInfo">
      جاري تحديد الموقع...
    </div>

    <button class="refresh-btn" id="refreshPrayerTimes">
      <i class="fas fa-sync-alt"></i> تحديث
    </button>
  </div>

  <div class="container">
    <div class="header">
      <div class="mosque-icon">
        <i class="fas fa-mosque"></i>
      </div>
      <h1>فضيلة الشيخ الدكتور<br>إبراهيم الحصري الأزهري</h1>
      <p>إنضم مع فضيلة الشيخ لمتابعة الدروس والمحاضرات والخطب الجديدة من جامع علي آغا 🕌</p>

      <!-- آية عشوائية -->
      <div class="random-ayah scroll-effect">
        <div class="text" id="randomAyahText">"يَا أَيُّهَا الَّذِينَ آمَنُوا اتَّقُوا اللَّهَ وَقُولُوا قَوْلًا
          سَدِيدًا"</div>
        <div class="surah-name">سورة الأحزاب - الآية 70</div>
      </div>
     <!-- عداد الزيارات -->
<div class="visitor-counter scroll-effect">
  <i class="fas fa-users"></i>
  <span id="visitCount">0</span> زائر للموقع
</div>
    </div>

    <div class="social-links">
      <a href="https://www.facebook.com/groups/7495656690521131/?ref=share&mibextid=CTbP7E" target="_blank"
        class="social-card facebook scroll-effect"
        data-ayah="وَتَعَاوَنُوا عَلَى الْبِرِّ وَالتَّقْوَىٰ ۖ وَلَا تَعَاوَنُوا عَلَى الْإِثْمِ وَالْعُدْوَانِ ۚ وَاتَّقُوا اللَّهَ ۖ إِنَّ اللَّهَ شَدِيدُ الْعِقَابِ"
        data-surah="المائدة: 2">
        <div class="social-icon"><i class="fab fa-facebook-f"></i></div>
        <div class="social-name">فيسبوك</div>
      </a>

      <a href="https://youtube.com/@elshakh.ebrahim?si=vB2Nc92TIYnrDRbN" target="_blank"
        class="social-card youtube scroll-effect"
        data-ayah="وَمَنْ أَحْسَنُ قَوْلًا مِّمَّن دَعَا إِلَى اللَّهِ وَعَمِلَ صَالِحًا وَقَالَ إِنَّنِي مِنَ الْمُسْلِمِينَ"
        data-surah="فصلت: 33">
        <div class="social-icon"><i class="fab fa-youtube"></i></div>
        <div class="social-name">يوتيوب</div>
      </a>

      <a href="https://chat.whatsapp.com/LPRrIJOjQ162o6HHC4nRg2" target="_blank"
        class="social-card whatsapp scroll-effect"
        data-ayah="ادْعُ إِلَىٰ سَبِيلِ رَبِّكَ بِالْحِكْمَةِ وَالْمَوْعِظَةِ الْحَسَنَةِ ۖ وَجَادِلْهُم بِالَّتِي هِيَ أَحْسَنُ"
        data-surah="النحل: 125">
        <div class="social-icon"><i class="fab fa-whatsapp"></i></div>
        <div class="social-name">واتساب</div>
      </a>

      <a href="https://t.me/Sheikh_Ibrahim" target="_blank" class="social-card telegram scroll-effect"
        data-ayah="وَقُل رَّبِّ زِدْنِي عِلْمًا" data-surah="طه: 114">
        <div class="social-icon"><i class="fab fa-telegram-plane"></i></div>
        <div class="social-name">تلغرام</div>
      </a>

      <a href="javascript:location.reload();" class="social-card website scroll-effect"
        data-ayah="إِنَّمَا يَعْمُرُ مَسَاجِدَ اللَّهِ مَنْ آمَنَ بِاللَّهِ وَالْيَوْمِ الْآخِرِ"
        data-surah="التوبة: 18">
        <div class="social-icon"><i class="fas fa-globe-africa"></i></div>
        <div class="social-name">الموقع الرسمي</div>
        <br>
        <h3>قريبا...</h3>
      </a>
    </div>

    <div class="signature scroll-effect">
      © جميع الحقوق محفوظة - الموقع الرسمي لفضيلة الشيخ الدكتور<br>
      إبراهيم الحصري الأزهري<br>
      <span id="currentDate"></span> <br>جامع علي آغا 🕌
    </div>
  </div>

  <!-- زر العودة للأعلى -->
  <button onclick="scrollToTop()" id="scrollTopBtn" title="العودة للأعلى"><i class="fas fa-arrow-up"></i></button>

  <!-- زر المشاركة -->
  <button onclick="shareWebsite()" id="shareBtn" title="مشاركة الموقع"><i class="fas fa-share-alt"></i></button>

  <script>
    // إضافة متغيرات لتتبع حالة السكرول
    let lastScrollPosition = 0;
    let isPrayerMenuOpen = false;

    document.addEventListener('DOMContentLoaded', function () {
      // إنشاء جزيئات متحركة
      const colors = ['rgba(0, 173, 181, 0.3)', 'rgba(255, 211, 105, 0.3)', 'rgba(238, 238, 238, 0.3)'];
      for (let i = 0; i < 30; i++) {
        const particle = document.createElement('div');
        particle.classList.add('particle');
        const size = Math.random() * 10 + 5;
        const posX = Math.random() * window.innerWidth;
        const posY = Math.random() * window.innerHeight;
        const color = colors[Math.floor(Math.random() * colors.length)];
        const duration = Math.random() * 20 + 10;
        const delay = Math.random() * 10;
        particle.style.width = `${size}px`;
        particle.style.height = `${size}px`;
        particle.style.left = `${posX}px`;
        particle.style.top = `${posY}px`;
        particle.style.background = color;
        particle.style.animation = `float ${duration}s ease-in-out ${delay}s infinite`;
        document.body.appendChild(particle);
      }

      // تفعيل تأثيرات التمرير
      initScrollEffects();

      // عرض التاريخ الحالي
      const options = { year: 'numeric', month: 'long', day: 'numeric' };
      const today = new Date();
      document.getElementById('currentDate').textContent = today.toLocaleDateString('ar-EG', options);

      // تحميل آية عشوائية
      loadRandomAyah();

      // تحميل أوقات الصلاة لمصر
      loadPrayerTimesForEgypt();

      // زر التحديث
      document.getElementById('refreshPrayerTimes').addEventListener('click', function () {
        loadPrayerTimesForEgypt();
      });

      // التحكم في عرض/إخفاء مواعيد الصلاة
      document.getElementById('prayerToggleBtn').addEventListener('click', function () {
        const prayerContainer = document.getElementById('prayerTimesContainer');
        prayerContainer.classList.toggle('show');
        isPrayerMenuOpen = prayerContainer.classList.contains('show');

        // تغيير أيقونة الزر حسب الحالة
        const icon = this.querySelector('i');
        if (isPrayerMenuOpen) {
          icon.classList.remove('fa-mosque');
          icon.classList.add('fa-times');
          this.querySelector('span').textContent = 'إغلاق';
        } else {
          icon.classList.remove('fa-times');
          icon.classList.add('fa-mosque');
          this.querySelector('span').textContent = 'أوقات الصلاة';
        }
      });

      // إغلاق القائمة عند النقر خارجها
      document.addEventListener('click', function (event) {
        const prayerContainer = document.getElementById('prayerTimesContainer');
        const toggleBtn = document.getElementById('prayerToggleBtn');

        if (!prayerContainer.contains(event.target) && !toggleBtn.contains(event.target)) {
          if (prayerContainer.classList.contains('show')) {
            prayerContainer.classList.remove('show');
            isPrayerMenuOpen = false;
            const icon = toggleBtn.querySelector('i');
            icon.classList.remove('fa-times');
            icon.classList.add('fa-mosque');
            toggleBtn.querySelector('span').textContent = 'أوقات الصلاة';
          }
        }
      });
    });

    // دالة للتعامل مع اتجاه السكرول
    function handleScrollDirection() {
      const currentScrollPosition = window.scrollY || document.documentElement.scrollTop;
      const prayerContainer = document.getElementById('prayerTimesContainer');
      const toggleBtn = document.getElementById('prayerToggleBtn');

      // إذا كان المستخدم يمرر لأسفل
      if (currentScrollPosition > lastScrollPosition) {
        // إخفاء القائمة إذا كانت مفتوحة
        if (prayerContainer.classList.contains('show')) {
          prayerContainer.classList.remove('show');
          isPrayerMenuOpen = true; // نحتفظ بحالة أنها كانت مفتوحة
        }
      }
      // إذا كان المستخدم يمرر لأعلى
      else if (currentScrollPosition < lastScrollPosition) {
        // إعادة إظهار القائمة إذا كانت مفتوحة سابقاً
        if (isPrayerMenuOpen && currentScrollPosition < 100) {
          prayerContainer.classList.add('show');
        }
      }

      // إذا وصلنا لأعلى الصفحة، نعيد تعيين الحالة
      if (currentScrollPosition <= 0) {
        isPrayerMenuOpen = false;
      }

      lastScrollPosition = currentScrollPosition;
    }

    // دالة لمشاركة رابط الموقع
    function shareWebsite() {
      if (navigator.share) {
        navigator.share({
          title: document.title,
          url: window.location.href
        }).then(() => {
          console.log('تمت مشاركة الرابط بنجاح');
        }).catch((error) => {
          console.error('حدث خطأ أثناء مشاركة الرابط: ', error);
        });
      } else {
        alert("متصفحك لا يدعم ميزة المشاركة، يمكنك نسخ الرابط يدوياً: " + window.location.href);
      }
    }

    // دالة للتمرير إلى الأعلى
    function scrollToTop() {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    }

    // عرض/إخفاء زر العودة للأعلى عند التمرير
    window.onscroll = function () {
      showScrollButton();
      updateProgressBar();
      togglePrayerButtonVisibility();
      handleScrollDirection();
    };

    function showScrollButton() {
      const btn = document.getElementById("scrollTopBtn");
      if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
        btn.style.display = "flex";
      } else {
        btn.style.display = "none";
      }
    }

    // إظهار/إخفاء زر مواعيد الصلاة عند التمرير
    function togglePrayerButtonVisibility() {
      const prayerBtn = document.getElementById("prayerToggleBtn");
      const scrollPosition = window.scrollY || document.documentElement.scrollTop;

      if (scrollPosition > 100) {
        prayerBtn.classList.add('hide');
      } else {
        prayerBtn.classList.remove('hide');
      }
    }

    // تحديث شريط التقدم
    function updateProgressBar() {
      const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
      const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      const scrolled = (winScroll / height) * 100;
      document.getElementById("progressBar").style.width = scrolled + "%";
    }

    // تأثيرات التمرير للعناصر
    function initScrollEffects() {
      const scrollElements = document.querySelectorAll('.scroll-effect');

      const elementInView = (el, dividend = 1) => {
        const elementTop = el.getBoundingClientRect().top;
        return (
          elementTop <= (window.innerHeight || document.documentElement.clientHeight) / dividend
        );
      };

      const displayScrollElement = (element) => {
        element.classList.add('visible');
      };

      const handleScrollAnimation = () => {
        scrollElements.forEach((el) => {
          if (elementInView(el, 1.2)) {
            displayScrollElement(el);
          }
        });
      };

      // تفعيل عند التحميل أولاً
      scrollElements.forEach((el) => {
        if (elementInView(el, 1.2)) {
          displayScrollElement(el);
        }
      });

      // ثم تفعيل عند التمرير
      window.addEventListener('scroll', () => {
        handleScrollAnimation();
      });
    }

    // آية عشوائية
    async function loadRandomAyah() {
      try {
        // يمكن استبدال هذا بطلب API حقيقي لآيات القرآن
        const ayahs = [
          { text: "يَا أَيُّهَا الَّذِينَ آمَنُوا اتَّقُوا اللَّهَ وَقُولُوا قَوْلًا سَدِيدًا", surah: "سورة الأحزاب - الآية 70" },
          { text: "إِنَّ اللَّهَ مَعَ الصَّابِرِينَ", surah: "سورة البقرة - الآية 153" },
          { text: "وَذَكِّرْ فَإِنَّ الذِّكْرَىٰ تَنفَعُ الْمُؤْمِنِينَ", surah: "سورة الذاريات - الآية 55" },
          { text: "وَمَا تَوْفِيقِي إِلَّا بِاللَّهِ ۚ عَلَيْهِ تَوَكَّلْتُ وَإِلَيْهِ أُنِيبُ", surah: "سورة هود - الآية 88" },
          { text: "وَاسْتَعِينُوا بِالصَّبْرِ وَالصَّلَاةِ ۚ وَإِنَّهَا لَكَبِيرَةٌ إِلَّا عَلَى الْخَاشِعِينَ", surah: "سورة البقرة - الآية 45" },
          { text: "رَبَّنَا آتِنَا فِي الدُّنْيَا حَسَنَةً وَفِي الْآخِرَةِ حَسَنَةً وَقِنَا عَذَابَ النَّارِ", surah: "سورة البقرة - الآية 201" },
          { text: "إِنَّمَا يُوَفَّى الصَّابِرُونَ أَجْرَهُم بِغَيْرِ حِسَابٍ", surah: "سورة الزمر - الآية 10" },
          { text: "وَمَن يَتَّقِ اللَّهَ يَجْعَل لَّهُ مَخْرَجًا", surah: "سورة الطلاق - الآية 2" },
          { text: "فَإِنَّ مَعَ الْعُسْرِ يُسْرًا، إِنَّ مَعَ الْعُسْرِ يُسْرًا", surah: "سورة الشرح - الآية 5-6" },
          { text: "وَتَوَكَّلْ عَلَى الْحَيِّ الَّذِي لَا يَمُوتُ", surah: "سورة الفرقان - الآية 58" },
          { text: "وَإِذَا سَأَلَكَ عِبَادِي عَنِّي فَإِنِّي قَرِيبٌ ۖ أُجِيبُ دَعْوَةَ الدَّاعِ إِذَا دَعَانِ", surah: "سورة البقرة - الآية 186" },
          { text: "وَلَا تَيْأَسُوا مِن رَّوْحِ اللَّهِ ۖ إِنَّهُ لَا يَيْأَسُ مِن رَّوْحِ اللَّهِ إِلَّا الْقَوْمُ الْكَافِرُونَ", surah: "سورة يوسف - الآية 87" },
          { text: "وَلَنَبْلُوَنَّكُم بِشَيْءٍ مِّنَ الْخَوْفِ وَالْجُوعِ وَنَقْصٍ مِّنَ الْأَمْوَالِ وَالْأَنفُسِ وَالثَّمَرَاتِ ۗ وَبَشِّرِ الصَّابِرِينَ", surah: "سورة البقرة - الآية 155" },
          { text: "وَمَا أَصَابَكُم مِّن مُّصِيبَةٍ فَبِمَا كَسَبَتْ أَيْدِيكُمْ وَيَعْفُو عَن كَثِيرٍ", surah: "سورة الشورى - الآية 30" },
          { text: "إِنَّ اللَّهَ لَا يُغَيِّرُ مَا بِقَوْمٍ حَتَّىٰ يُغَيِّرُوا مَا بِأَنفُسِهِمْ", surah: "سورة الرعد - الآية 11" }
        ];

        const randomAyah = ayahs[Math.floor(Math.random() * ayahs.length)];
        document.getElementById('randomAyahText').textContent = `"${randomAyah.text}"`;
        document.querySelector('.random-ayah .surah-name').textContent = randomAyah.surah;

        // تأثير الكتابة
        typeWriterEffect('randomAyahText', `"${randomAyah.text}"`);
      } catch (error) {
        console.error('Error loading random ayah:', error);
      }
    }

    // تأثير الكتابة على الآية
    function typeWriterEffect(elementId, text) {
      const element = document.getElementById(elementId);
      element.textContent = '';
      let i = 0;
      const speed = 50; // السرعة بالميلي ثانية

      function type() {
        if (i < text.length) {
          element.textContent += text.charAt(i);
          i++;
          setTimeout(type, speed);
        }
      }

      type();
    }

    // دالة لجلب أوقات الصلاة لمصر
    async function loadPrayerTimesForEgypt() {
      try {
        // تحديد الموقع الجغرافي للمستخدم
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            async (position) => {
              const { latitude, longitude } = position.coords;
              await fetchPrayerTimes(latitude, longitude, true);

              // عرض معلومات الموقع
              const city = await getCityName(latitude, longitude);
              document.getElementById('locationInfo').textContent = `موقعك الحالي: ${city || 'غير معروف'}`;
              document.getElementById('prayerLocation').textContent = city ? `${city}، مصر` : 'مصر';
            },
            async (error) => {
              console.error('Error getting location:', error);
              // استخدام القاهرة كافتراضي إذا لم يتم الحصول على الموقع
              await fetchPrayerTimes(30.0444, 31.2357, false);
              document.getElementById('locationInfo').textContent = 'تستخدم أوقات الصلاة لمدينة القاهرة (تحديد الموقع غير متاح)';
              document.getElementById('prayerLocation').textContent = 'القاهرة، مصر';
            }
          );
        } else {
          // إذا المتصفح لا يدعم تحديد الموقع
          await fetchPrayerTimes(30.0444, 31.2357, false);
          document.getElementById('locationInfo').textContent = 'تستخدم أوقات الصلاة لمدينة القاهرة (تحديد الموقع غير مدعوم)';
          document.getElementById('prayerLocation').textContent = 'القاهرة، مصر';
        }
      } catch (error) {
        console.error('Error loading prayer times:', error);
        document.getElementById('locationInfo').textContent = 'حدث خطأ في جلب أوقات الصلاة';
      }
    }

    // دالة لجلب أوقات الصلاة من API
    async function fetchPrayerTimes(lat, lng, isUserLocation) {
      try {
        const date = new Date();
        const year = date.getFullYear();
        const month = date.getMonth() + 1;
        const day = date.getDate();

        // استخدام API لأوقات الصلاة (مثال باستخدام Aladhan API)
        const response = await fetch(
          `https://api.aladhan.com/v1/timings/${day}-${month}-${year}?latitude=${lat}&longitude=${lng}&method=5`
        );

        const data = await response.json();

        if (data.code === 200 && data.data) {
          const timings = data.data.timings;

          // عرض أوقات الصلاة
          document.getElementById('fajrValue').textContent = formatTime(timings.Fajr);
          document.getElementById('dhuhrValue').textContent = formatTime(timings.Dhuhr);
          document.getElementById('asrValue').textContent = formatTime(timings.Asr);
          document.getElementById('maghribValue').textContent = formatTime(timings.Maghrib);
          document.getElementById('ishaValue').textContent = formatTime(timings.Isha);

          // تحديد الصلاة الحالية
          highlightCurrentPrayer(timings);

          // إذا لم يكن موقع المستخدم، نعرض المدينة المحددة
          if (!isUserLocation && data.data.meta && data.data.meta.timezone) {
            const city = data.data.meta.timezone.split('/')[1] || 'القاهرة';
            document.getElementById('locationInfo').textContent = `تستخدم أوقات الصلاة لمدينة ${city}`;
            document.getElementById('prayerLocation').textContent = `${city}، مصر`;
          }
        }
      } catch (error) {
        console.error('Error fetching prayer times:', error);
        throw error;
      }
    }

    // دالة لتنسيق الوقت
    function formatTime(timeStr) {
      return timeStr.substring(0, 5); // نأخذ فقط الساعات والدقائق
    }

    // دالة لتحديد الصلاة الحالية
    function highlightCurrentPrayer(timings) {
      const now = new Date();
      const currentTime = now.getHours() * 60 + now.getMinutes();

      // إزالة التنشيط من جميع الأوقات
      document.querySelectorAll('.prayer-time').forEach(el => {
        el.classList.remove('active');
      });

      // تحويل أوقات الصلاة إلى دقائق
      const prayerTimes = [
        { name: 'fajrTime', time: convertToMinutes(timings.Fajr) },
        { name: 'dhuhrTime', time: convertToMinutes(timings.Dhuhr) },
        { name: 'asrTime', time: convertToMinutes(timings.Asr) },
        { name: 'maghribTime', time: convertToMinutes(timings.Maghrib) },
        { name: 'ishaTime', time: convertToMinutes(timings.Isha) }
      ];

      // تحديد الصلاة الحالية
      let currentPrayer = null;
      for (let i = 0; i < prayerTimes.length; i++) {
        if (currentTime < prayerTimes[i].time) {
          currentPrayer = i > 0 ? prayerTimes[i - 1].name : prayerTimes[prayerTimes.length - 1].name;
          break;
        }
      }

      // إذا كان الوقت بعد العشاء وقبل الفجر
      if (!currentPrayer) {
        currentPrayer = prayerTimes[prayerTimes.length - 1].name;
      }

      // تنشيط الصلاة الحالية
      document.getElementById(currentPrayer).classList.add('active');
      document.getElementById('currentPrayerTitle').textContent =
        document.getElementById(currentPrayer).querySelector('.prayer-name').textContent;
    }

    // دالة لتحويل الوقت من نص إلى دقائق
    function convertToMinutes(timeStr) {
      const [hours, minutes] = timeStr.split(':').map(Number);
      return hours * 60 + minutes;
    }

    // دالة للحصول على اسم المدينة من الإحداثيات
    async function getCityName(lat, lng) {
      try {
        const response = await fetch(
          `https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${lat}&longitude=${lng}&localityLanguage=ar`
        );
        const data = await response.json();
        return data.city || data.locality || null;
      } catch (error) {
        console.error('Error getting city name:', error);
        return null;
      }
    }
   
  </script>
</body>

</html>
